<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Promptkopierare</title>
  <style>
    :root{
      --bg:#0f172a; --fg:#e5e7eb; --muted:#94a3b8; --card:#111827; --accent:#22c55e; --accent-2:#3b82f6; --danger:#ef4444;
      --br:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100dvh; background:linear-gradient(135deg,#0b1020,#121a36 60%,#0b1020);
      color:var(--fg); font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      display:grid; place-items:center; padding:24px;
    }
    .wrap{
      width:min(900px,95vw); background:rgba(17,24,39,.9); border:1px solid rgba(148,163,184,.15);
      border-radius:var(--br); box-shadow:0 10px 30px rgba(0,0,0,.35); padding:20px 20px 16px;
    }
    h1{margin:0 0 10px; font-size:22px; font-weight:650}
    .sub{color:var(--muted); margin-bottom:14px; font-size:14px}
    textarea{
      width:100%; height:48svh; min-height:260px; resize:vertical; border:1px solid rgba(148,163,184,.25);
      border-radius:14px; background:#0b1224; color:var(--fg); padding:14px 14px 46px 14px; outline:none;
      caret-color:#fff; box-shadow:inset 0 1px 0 rgba(255,255,255,.03);
    }
    .toolbar{
      display:flex; gap:8px; align-items:center; margin-top:-40px; padding:0 8px 0 6px;
    }
    .grow{flex:1}
    .stat{color:var(--muted); font-size:12px; user-select:none}
    button{
      appearance:none; border:1px solid rgba(148,163,184,.25); background:#0a1222; color:var(--fg);
      padding:9px 14px; border-radius:12px; cursor:pointer; font-weight:600;
      transition:.18s ease; box-shadow:0 1px 0 rgba(255,255,255,.04);
    }
    button:hover{transform:translateY(-1px); box-shadow:0 4px 14px rgba(0,0,0,.35)}
    .ghost{border-color:rgba(148,163,184,.18); color:#cbd5e1}
    .copy{background:linear-gradient(135deg,var(--accent-2),var(--accent)); border-color:transparent; color:#05121f}
    .danger{border-color:rgba(239,68,68,.35); color:#fecaca}
    .toast{
      position:fixed; left:50%; bottom:22px; transform:translate(-50%,30px);
      background:#0b1224; border:1px solid rgba(148,163,184,.25); color:#e5e7eb; padding:10px 14px; border-radius:12px;
      opacity:0; pointer-events:none; transition:.22s ease; box-shadow:0 8px 22px rgba(0,0,0,.45);
      font-size:14px;
    }
    .toast.show{opacity:1; transform:translate(-50%,0)}
    .row{display:flex; gap:8px; align-items:center; margin-top:10px}
    .small{font-size:12px; color:var(--muted)}
    a.help{color:#a7f3d0; text-decoration:none}
    a.help:hover{text-decoration:underline}
  </style>
</head>
<body>
  <main class="wrap" role="main">
    <h1>Promptkopierare</h1>
    <div class="sub">Klistra in eller skriv din prompt. Texten sparas lokalt och kan kopieras med ett klick.</div>

    <textarea id="ta" placeholder="Klistra in din prompt här…"></textarea>

    <div class="toolbar">
      <div class="stat" id="stat">0 tecken</div>
      <div class="grow"></div>
      <button class="ghost" id="select">Markera allt</button>
      <button class="danger" id="clear">Rensa</button>
      <button class="copy" id="copy">Kopiera</button>
    </div>

    <div class="row small">
      <span>Tips: Klippbokskopiering funkar bäst på https/localhost. Den här sidan har även en äldre fallback.</span>
    </div>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true"></div>

  <script>
    const ta = document.getElementById('ta');
    const stat = document.getElementById('stat');
    const toast = document.getElementById('toast');
    const storageKey = 'promptkopierare:text';

    function updateStat(){
      const len = ta.value.length;
      stat.textContent = `${len} ${len === 1 ? 'tecken' : 'tecken'}`;
    }

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add('show');
      clearTimeout(showToast.tid);
      showToast.tid = setTimeout(()=> toast.classList.remove('show'), 1600);
    }

    // Init
    ta.value = localStorage.getItem(storageKey) ?? '';
    updateStat();
    ta.addEventListener('input', () => {
      localStorage.setItem(storageKey, ta.value);
      updateStat();
    });

    // Buttons
    document.getElementById('clear').addEventListener('click', () => {
      if (ta.value && !confirm('Rensa texten?')) return;
      ta.value = '';
      localStorage.removeItem(storageKey);
      updateStat();
      ta.focus();
      showToast('Rensat');
    });

    document.getElementById('select').addEventListener('click', () => {
      ta.focus();
      ta.select();
      showToast('Markerat — Ctrl/Cmd+C för att kopiera');
    });

    document.getElementById('copy').addEventListener('click', async () => {
      try {
        // Modern, säkert läge (kräver https/localhost i vissa webbläsare)
        await navigator.clipboard.writeText(ta.value);
        showToast('Kopierat till urklipp');
      } catch (err) {
        // Fallback för fil:// eller äldre webbläsare
        try {
          ta.focus();
          ta.select();
          const ok = document.execCommand('copy');
          window.getSelection()?.removeAllRanges?.();
          showToast(ok ? 'Kopierat (fallback)' : 'Kunde inte kopiera — använd Ctrl/Cmd+C');
        } catch (e2) {
          showToast('Kunde inte kopiera — använd Ctrl/Cmd+C');
        }
      }
    });
  </script>
</body>
</html>
